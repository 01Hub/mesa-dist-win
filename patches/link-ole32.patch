diff --git a/scons/gallium.py b/scons/gallium.py
index 963834a..0be234e 100755
--- a/scons/gallium.py
+++ b/scons/gallium.py
@@ -658,6 +658,8 @@ def generate(env):
 
     env.Tool('yacc')
     if host_platform.system() == 'Windows':
+        if not env['msvc']:
+            libs += ['shell32', 'version', 'uuid', 'ole32']
         if check_prog(env, 'win_bison'):
             env["YACC"] = 'win_bison'
 
diff --git a/scons/llvm.py b/scons/llvm.py
index a84ad51..31b8956 100644
--- a/scons/llvm.py
+++ b/scons/llvm.py
@@ -123,7 +123,7 @@ def generate(env):
             if env['platform'] == 'windows' and env['crosscompile']:
                 # LLVM 5.0 requires MinGW w/ pthreads due to use of std::thread and friends.
                 assert env['gcc']
-                env['CXX'] = env['CXX'] + '-posix'
+                env['CXX'] = env['CXX'] + ' -posix'
         elif llvm_version >= distutils.version.LooseVersion('4.0'):
             env.Prepend(LIBS = [
                 'LLVMX86Disassembler', 'LLVMX86AsmParser',
@@ -216,6 +216,11 @@ def generate(env):
             'ole32',
             'uuid',
         ])
+        if not env['msvc']:
+            env.Append(LIBS = [
+                 'z',
+                 'version',
+            ])
 
         if env['msvc']:
             # Some of the LLVM C headers use the inline keyword without
diff --git a/src/gallium/targets/graw-gdi/SConscript b/src/gallium/targets/graw-gdi/SConscript
index e59127c..0a52bb5 100644
--- a/src/gallium/targets/graw-gdi/SConscript
+++ b/src/gallium/targets/graw-gdi/SConscript
@@ -14,6 +14,7 @@ env.Prepend(LIBS = [
     gallium,
     'gdi32',
     'user32',
+    'ole32',
     'ws2_32',
 ])
 
diff --git a/src/gallium/targets/libgl-gdi/SConscript b/src/gallium/targets/libgl-gdi/SConscript
index 94feca2..4b0b562 100644
--- a/src/gallium/targets/libgl-gdi/SConscript
+++ b/src/gallium/targets/libgl-gdi/SConscript
@@ -15,6 +15,7 @@ env.Append(LIBS = [
     'gdi32',
     'user32',
     'kernel32',
+    'ole32',
     'ws2_32',
     'advapi32',
 ])
diff --git a/src/glx/Makefile.am b/src/glx/Makefile.am
index d06ae29..75345e0 100644
--- a/src/glx/Makefile.am
+++ b/src/glx/Makefile.am
@@ -188,7 +188,7 @@ lib@GL_LIB@_la_LIBADD = $(GL_LIBS)
 lib@GL_LIB@_la_LDFLAGS = $(GL_LDFLAGS)
 
 if HAVE_WINDOWSDRI
-lib@GL_LIB@_la_LDFLAGS += -lgdi32 -lopengl32 -Wl,--disable-stdcall-fixup
+lib@GL_LIB@_la_LDFLAGS += -lgdi32 -lole32 -lopengl32 -Wl,--disable-stdcall-fixup
 endif
 
 SUBDIRS += . tests
